Calculating the project graph on the Nx Daemon
Calculating the project graph on the Nx Daemon is taking longer than expected. Re-run with NX_DAEMON=false to see more details.

[2m> [22m[2mnx run[22m eslint-plugin-secure-coding:test --testFile=missing-rules-repro.test.ts

[1m[46m RUN [49m[22m [36mv4.0.6 [39m[90m/Users/ofri/repos/ofriperetz.dev/eslint/packages/eslint-plugin-secure-coding[39m
[1m[46m RUN [49m[22m [36mv4.0.6 [39m[90m/Users/ofri/repos/ofriperetz.dev/eslint/packages/eslint-plugin-secure-coding[39m
 [32mâœ“[39m [30m[42m secure-coding [49m[39m src/tests/security/missing-rules-repro.test.ts[2m > [22mno-directive-injection-repro[2m > [22minvalid[2m > [22m
        const ejs = require('ejs');
        const userTemplate = req.body.template; 
        const html = ejs.render(userTemplate, { data });
      [32m 58[2mms[22m[39m
 [32mâœ“[39m [30m[42m secure-coding [49m[39m src/tests/security/missing-rules-repro.test.ts[2m > [22mno-unsanitized-html-repro[2m > [22minvalid[2m > [22m
        const userContent = req.body.content;
        document.getElementById('app').innerHTML = userContent;
      [32m 13[2mms[22m[39m
 [32mâœ“[39m [30m[42m secure-coding [49m[39m src/tests/security/missing-rules-repro.test.ts[2m > [22mdetect-child-process-repro[2m > [22minvalid[2m > [22m
        const { exec } = require('child_process');
        const userInput = req.body.input;
        exec(`ls ${userInput}`, (err, stdout) => {
          console.log(stdout);
        });
      [32m 11[2mms[22m[39m
 [32mâœ“[39m [30m[42m secure-coding [49m[39m src/tests/security/missing-rules-repro.test.ts[2m > [22mno-toctou-vulnerability-repro[2m > [22minvalid[2m > [22m
        const fs = require('fs');
        if (fs.existsSync(filePath)) { // Check
            const data = fs.readFileSync(filePath); // Use
        }
      [32m 10[2mms[22m[39m
 [32mâœ“[39m [30m[42m secure-coding [49m[39m src/tests/security/missing-rules-repro.test.ts[2m > [22mno-unescaped-url-parameter-repro[2m > [22minvalid[2m > [22m
        const returnUrl = new URLSearchParams(window.location.search).get('returnUrl');
        window.location.href = returnUrl; 
      [32m 7[2mms[22m[39m
 [32mâœ“[39m [30m[42m secure-coding [49m[39m src/tests/security/missing-rules-repro.test.ts[2m > [22mno-insecure-comparison-repro[2m > [22minvalid[2m > [22m
          if (userProvidedToken === storedSecretToken) {
            login();
          }
        [32m 7[2mms[22m[39m
 [32mâœ“[39m [30m[42m secure-coding [49m[39m src/tests/security/missing-rules-repro.test.ts[2m > [22mno-redos-vulnerable-regex-repro[2m > [22minvalid[2m > [22m
        const regex = /([a-z]+)+$/;
      [32m 6[2mms[22m[39m
 [32mâœ“[39m [30m[42m secure-coding [49m[39m src/tests/security/missing-rules-repro.test.ts[2m > [22mno-buffer-overread-repro[2m > [22minvalid[2m > [22m
        const buf = Buffer.from('hello');
        const idx = req.body.index;
        const char = buf.readUInt8(idx);
      [32m 7[2mms[22m[39m
 [32mâœ“[39m [30m[42m secure-coding [49m[39m src/tests/security/missing-rules-repro.test.ts[2m > [22mno-improper-sanitization-repro[2m > [22minvalid[2m > [22m
        const userInput = req.body.input;
        const sanitized = userInput.replace(/</g, '');
      [32m 7[2mms[22m[39m
 [32mâœ“[39m [30m[42m secure-coding [49m[39m src/tests/security/missing-rules-repro.test.ts[2m > [22mno-improper-type-validation-repro[2m > [22minvalid[2m > [22m
        const userInput = req.body.input;
        if (userInput) {
          // unsafe use
        }
      [32m 6[2mms[22m[39m
 [32mâœ“[39m [30m[42m secure-coding [49m[39m src/tests/security/missing-rules-repro.test.ts[2m > [22mno-privilege-escalation-repro[2m > [22minvalid[2m > [22m
        const user = await User.findById(id);
        user.role = req.body.role; 
        await user.save();
      [32m 8[2mms[22m[39m
 [32mâœ“[39m [30m[42m secure-coding [49m[39m src/tests/security/missing-rules-repro.test.ts[2m > [22mno-insecure-jwt-repro[2m > [22minvalid[2m > [22m
        const jwt = require('jsonwebtoken');
        jwt.verify(token, secret, { algorithms: ['none'] });
      [32m 7[2mms[22m[39m
 [32mâœ“[39m [30m[42m secure-coding [49m[39m src/tests/security/missing-rules-repro.test.ts [2m([22m[2m12 tests[22m[2m)[22m[32m 149[2mms[22m[39m
[2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[32m12 passed[39m[22m[90m (12)[39m
[2m   Start at [22m 22:18:39
[2m   Duration [22m 5.50s[2m (transform 460ms, setup 0ms, collect 4.75s, tests 149ms, environment 2ms, prepare 148ms)[22m
[2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[32m12 passed[39m[22m[90m (12)[39m
[2m   Start at [22m 22:18:39
[2m   Duration [22m 5.50s[2m (transform 460ms, setup 0ms, collect 4.75s, tests 149ms, environment 2ms, prepare 148ms)[22m



[0m[7m[1m[32m NX [39m[22m[27m[0m  [32mSuccessfully ran target [1mtest[22m for project eslint-plugin-secure-coding[39m


