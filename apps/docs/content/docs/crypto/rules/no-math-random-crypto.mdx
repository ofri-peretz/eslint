---
title: no-math-random-crypto
description: Disallow the use of Math.random() for security-sensitive tokens and identifiers.
---

# no-math-random-crypto

> No Math Random Crypto

**üö® Security rule** | **üí° Provides LLM-optimized guidance** | **‚ö†Ô∏è Set to error in `recommended`**

## Quick Summary

| Aspect            | Details                                                                  |
| ----------------- | ------------------------------------------------------------------------ |
| **CWE Reference** | [CWE-338](https://cwe.mitre.org/data/definitions/338.html)               |
| **Severity**      | Critical                                                                 |
| **Auto-Fix**      | ‚ùå No auto-fix available                                                 |
| **Category**      | Security                                                                 |
| **ESLint MCP**    | ‚úÖ Optimized for ESLint MCP integration                                  |
| **Best For**      | Protecting security-sensitive tokens and identifiers from predictability |

## Description

Disallow the use of `Math.random()` for generating values tagged with security-related keywords (e.g., `token`, `secret`, `password`). `Math.random()` is a PRNG that is not cryptographically secure and its output can be predicted.

## OWASP Mapping

- **OWASP Top 10**: [A02:2021](https://owasp.org/Top10/A02_2021-Cryptographic_Failures/) - Cryptographic Failures
- **CWE**: [CWE-338](https://cwe.mitre.org/data/definitions/338.html) - Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)

## Error Message Format

The rule provides **LLM-optimized error messages** (Compact 2-line format) with actionable security guidance:

```text
üîí [CWE-338](https://cwe.mitre.org/data/definitions/338.html) OWASP:A04 CVSS:9.1 | Weak PRNG for Security Context detected | CRITICAL [SOC2,PCI-DSS,HIPAA,ISO27001,NIST-CSF]
   Fix: Review and apply the recommended fix | https://owasp.org/Top10/A04_2021/
```

### Message Components

| Component                 | Purpose                | Example                                                                                                                                                                                                                         |
| :------------------------ | :--------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Risk Standards**        | Security benchmarks    | [CWE-338](https://cwe.mitre.org/data/definitions/338.html) [OWASP:A04](https://owasp.org/Top10/A04_2021-Injection/) [CVSS:9.1](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) |
| **Issue Description**     | Specific vulnerability | `Weak PRNG for Security Context detected`                                                                                                                                                                                       |
| **Severity & Compliance** | Impact assessment      | `CRITICAL [SOC2,PCI-DSS,HIPAA,ISO27001,NIST-CSF]`                                                                                                                                                                               |
| **Fix Instruction**       | Actionable remediation | `Follow the remediation steps below`                                                                                                                                                                                            |
| **Technical Truth**       | Official reference     | [OWASP Top 10](https://owasp.org/Top10/A04_2021-Injection/)                                                                                                                                                                     |

## Rule Details

Detects assignments of `Math.random()` to variables or object properties with names containing security keywords like `token`, `secret`, `password`, `key`, `salt`, `iv`, `nonce`, `csrf`, etc.

## Examples

### ‚ùå Incorrect

```javascript
const token = Math.random().toString(36);
const password = Math.random().toString(36);
const secret = Math.random();
const obj = { sessionKey: Math.random() };
```

### ‚úÖ Correct

```javascript
const count = Math.random() * 10; // Non-security context
const position = Math.random(); // Non-security context
const token = crypto.randomBytes(32).toString('hex'); // Secure alternative
```

## Options

| Option           | Type       | Default | Description                         |
| ---------------- | ---------- | ------- | ----------------------------------- |
| `allowInTests`   | `boolean`  | `true`  | Allow insecure random in test files |
| `customKeywords` | `string[]` | `[]`    | Additional keywords to flag         |

## When Not To Use It

Only for purely non-security contexts like UI positions, game mechanics, or mathematical simulations where predictability is not a concern.

## Known False Negatives

The following patterns are **not detected** due to static analysis limitations:

### Generic Variable Names

**Why**: If a security value is stored in a variable named `x` or `data`, it won't be flagged.

```typescript
// ‚ùå NOT DETECTED
const x = Math.random();
sendToken(x);
```

**Mitigation**: Use descriptive names.

### Complex Data Structures

**Why**: Values nested deep in arrays or dynamic objects may be missed.

```typescript
// ‚ùå NOT DETECTED
const list = [Math.random()];
const token = list[0];
```

**Mitigation**: Audit all random value usage.
