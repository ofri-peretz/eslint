---
title: no-static-iv
description: "CWE: CWE-329"
---

> **Keywords:** no-static-iv, initialization vector, hardcoded IV, deterministic encryption, security, ESLint rule, CWE-329, predictable crypto
> **CWE:** [CWE-329: Not Using an Unpredictable IV with CBC Mode](https://cwe.mitre.org/data/definitions/329.html)  
> **OWASP:** [OWASP Top 10 A02:2021 - Cryptographic Failures](https://owasp.org/Top10/A02_2021-Cryptographic_Failures/)

ESLint Rule: no-static-iv. This rule is part of [`eslint-plugin-crypto`](https://www.npmjs.com/package/eslint-plugin-crypto).

## Quick Summary

| Aspect         | Details                                 |
| -------------- | --------------------------------------- |
| **Severity**   | High (Cryptographic Failure)            |
| **Auto-Fix**   | ‚ùå No (requires logic update)           |
| **Category**   | Security / Cryptography                 |
| **ESLint MCP** | ‚úÖ Optimized for ESLint MCP integration |
| **Best For**   | Shared secrets and database encryption  |

## Vulnerability and Risk

**Vulnerability:** Use of static (hardcoded) strings or fixed buffers as Initialization Vectors (IVs) for symmetric encryption (e.g., AES).

**Risk:** Static IVs make encryption deterministic. If the same plaintext is encrypted twice with the same key and same static IV, the resulting ciphertext will be identical. This allows attackers to detect patterns, perform "chosen-plaintext" attacks, and in some cases, decrypt data without the secret key.

## Error Message Format

The rule provides **LLM-optimized error messages** (Compact 2-line format) with actionable security guidance:

```text
üîí CWE-329 OWASP:A02 | Static IV detected | HIGH [PredictableCrypto]
   Fix: Replace hardcoded IV with dynamic source: const iv = crypto.randomBytes(16) | https://cwe.mitre.org/data/definitions/329.html
```

### Message Components

| Component                 | Purpose                | Example                                                                                                   |
| :------------------------ | :--------------------- | :-------------------------------------------------------------------------------------------------------- |
| **Risk Standards**        | Security benchmarks    | [CWE-329](https://cwe.mitre.org/data/definitions/329.html) [OWASP:A02](https://owasp.org/Top10/A02_2021/) |
| **Issue Description**     | Specific vulnerability | `Static IV detected`                                                                                      |
| **Severity & Compliance** | Impact assessment      | `HIGH [PredictableCrypto]`                                                                                |
| **Fix Instruction**       | Actionable remediation | `Replace hardcoded IV with dynamic source`                                                                |
| **Technical Truth**       | Official reference     | [Deterministic Encryption](https://cwe.mitre.org/data/definitions/329.html)                               |

## Rule Details

This rule flags uses of `crypto.createCipheriv()` and `crypto.createDecipheriv()` where the 3rd argument (IV) is a string literal, a literal buffer, or a variable that appears to be static.

```mermaid
%%{init: {
  'theme': 'base',
  'themeVariables': {
    'primaryColor': '#f8fafc',
    'primaryTextColor': '#1e293b',
    'primaryBorderColor': '#334155',
    'lineColor': '#475569',
    'c0': '#f8fafc',
    'c1': '#f1f5f9',
    'c2': '#e2e8f0',
    'c3': '#cbd5e1'
  }
}}%%
flowchart TD
    A[createCipheriv Call] --> B{IV is a string literal?}
    B -->|Yes| C[üö® Static IV Risk]
    B -->|No| D{IV is Buffer.from('string')?}
    D -->|Yes| C
    D -->|No| E[‚úÖ Likely Dynamic]
    C --> F[üí° Suggest crypto.randomBytes]
```

### Why This Matters

| Issue                  | Impact                               | Solution                                               |
| ---------------------- | ------------------------------------ | ------------------------------------------------------ |
| üïµÔ∏è **Pattern Recon**   | Duplicate messages revealed to actor | Use a unique IV for every single encryption call       |
| üöÄ **Data Extraction** | High risk of plaintext recovery      | Ensure IVs are truly unpredictable and non-repeating   |
| üîí **Compliance**      | Violates FIPS/PCI-DSS standards      | Store the unique IV alongside the ciphertext in the DB |

## Configuration

This rule supports the following options:

```javascript
{
  "rules": {
    "crypto/no-static-iv": ["error", {
      "allowInTests": true // Allow fixed IVs in .test.js files for deterministic testing
    }]
  }
}
```

## Examples

### ‚ùå Incorrect

```javascript
// Hardcoded hex string as IV
const iv = '1234567890abcdef1234567890abcdef';
const cipher = crypto.createCipheriv('aes-256-cbc', key, iv);

// Hardcoded Buffer
const iv = Buffer.from('my-static-string-iv');
const cipher = crypto.createCipheriv('aes-256-cbc', key, iv);
```

### ‚úÖ Correct

```javascript
// Dynamic IV generation (Recommended)
const iv = crypto.randomBytes(16);
const cipher = crypto.createCipheriv('aes-256-cbc', key, iv);

// Passing dynamic IV stored in DB
const iv = Buffer.from(encryptedPackage.iv, 'hex');
const decipher = crypto.createDecipheriv('aes-256-cbc', key, iv);
```

## Known False Negatives

The following patterns are **not detected** due to static analysis limitations:

### Complexity of Source

**Why**: If the IV is built from a complex sequence of non-literal strings (e.g. `const iv = 'a' + 'b' + 'c'`), the rule logic may skip it.

```javascript
const iv = getParts().join('');
crypto.createCipheriv(algo, key, iv); // ‚ùå NOT DETECTED
```

**Mitigation**: Always use `crypto.randomBytes(16)` and document the source of all IV variables.

### IV Reuse

**Why**: This rule detects _static_ IVs, but it cannot detect if a _randomly generated_ IV is being reused incorrectly for multiple messages (which is also a vulnerability).

**Mitigation**: Audit your encryption service logic to ensure `randomBytes` is called once per encryption operation.

## References

- [CWE-329: Not Using an Unpredictable IV with CBC Mode](https://cwe.mitre.org/data/definitions/329.html)
- [OWASP Cryptographic Storage Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#initialization-vectors)
- [Why you should never reuse an IV](https://en.wikipedia.org/wiki/Initialization_vector#IV_reuse)
