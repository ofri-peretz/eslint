---
title: require-schema-validation
description: Requires validation options on Mongoose schema fields to prevent invalid or malicious data.
---

> **Keywords:** [CWE-20](https://cwe.mitre.org/data/definitions/20.html), input validation, Mongoose, schema, security

Requires validation options on Mongoose schema fields to prevent invalid or malicious data.

‚ö†Ô∏è This rule **warns** by default in the `recommended` config.

## Quick Summary

| Aspect            | Details                            |
| ----------------- | ---------------------------------- |
| **CWE Reference** | [CWE-20](https://cwe.mitre.org/data/definitions/20.html) (Improper Input Validation) |
| **OWASP**         | [A04:2021](https://owasp.org/Top10/A04_2021-Insecure_Design/) - Insecure Design         |
| **Severity**      | Medium (CVSS: 6.1)                 |
| **Category**      | Security                           |

## Error Message Format

The rule provides **LLM-optimized error messages** (Compact 2-line format) with actionable security guidance:

```text
üîí [CWE-20](https://cwe.mitre.org/data/definitions/20.html) OWASP:A06 CVSS:7.5 | Improper Input Validation detected | HIGH [SOC2,PCI-DSS,HIPAA,GDPR,ISO27001]
   Fix: Review and apply the recommended fix | https://owasp.org/Top10/A06_2021/
```

### Message Components

| Component | Purpose | Example |
| :--- | :--- | :--- |
| **Risk Standards** | Security benchmarks | [CWE-20](https://cwe.mitre.org/data/definitions/20.html) [OWASP:A06](https://owasp.org/Top10/A06_2021-Injection/) [CVSS:7.5](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) |
| **Issue Description** | Specific vulnerability | `Improper Input Validation detected` |
| **Severity & Compliance** | Impact assessment | `HIGH [SOC2,PCI-DSS,HIPAA,GDPR,ISO27001]` |
| **Fix Instruction** | Actionable remediation | `Follow the remediation steps below` |
| **Technical Truth** | Official reference | [OWASP Top 10](https://owasp.org/Top10/A06_2021-Injection/) |

## Rule Details

Mongoose schemas without validation allow arbitrary data, potentially leading to:

- Data corruption
- Injection attacks
- Business logic bypass

### ‚ùå Incorrect

```typescript
// No validation - accepts any value
const userSchema = new Schema({
  email: String,
  role: String,
  age: Number,
});
```

### ‚úÖ Correct

```typescript
const userSchema = new Schema({
  email: {
    type: String,
    required: true,
    match: /^[^\s@]+@[^\s@]+\.[^\s@]+$/,
    maxlength: 255,
  },
  role: {
    type: String,
    enum: ['user', 'admin', 'moderator'],
    default: 'user',
  },
  age: {
    type: Number,
    min: 0,
    max: 150,
    validate: {
      validator: Number.isInteger,
      message: 'Age must be an integer',
    },
  },
});
```

## Known False Negatives

### Dynamic Schema Creation

```typescript
// ‚ùå NOT DETECTED
const fields = {};
fields[fieldName] = String;
const schema = new Schema(fields);
```

## When Not To Use It

- For flexible schema designs (schemaless approach)
- When validation is handled at application layer

## References

- [Mongoose Validation](https://mongoosejs.com/docs/validation.html)
- [CWE-20](https://cwe.mitre.org/data/definitions/20.html)
