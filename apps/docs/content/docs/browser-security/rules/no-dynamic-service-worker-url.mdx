---
title: no-dynamic-service-worker-url
description: No Dynamic Service Worker Url
---

> No Dynamic Service Worker Url

Prevent dynamic URLs in service worker registration.

## ‚ö†Ô∏è Security Issue

| Property     | Value                                                                                                                |
| ------------ | -------------------------------------------------------------------------------------------------------------------- |
| **CWE**      | [CWE-829: Inclusion of Functionality from Untrusted Control Sphere](https://cwe.mitre.org/data/definitions/829.html) |
| **OWASP**    | [A08:2021](https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/) - Software and Data Integrity Failures                                                                      |
| **CVSS**     | 8.1 (High)                                                                                                           |
| **Severity** | HIGH                                                                                                                 |

## üìã Description

Dynamically constructing service worker URLs can lead to loading malicious scripts that have full control over network requests for your site.

## ‚ùå Incorrect

```javascript
// Dynamic URL construction
navigator.serviceWorker.register(userInput);

// Template literal with expression
navigator.serviceWorker.register(`${basePath}/sw.js`);

// Concatenation
navigator.serviceWorker.register(path + '/worker.js');
```

## ‚úÖ Correct

```javascript
// Static string URL
navigator.serviceWorker.register('/sw.js');

// Constant URL
navigator.serviceWorker.register('/service-worker.js', { scope: '/' });
```

## üõ†Ô∏è Options

```json
{
  "rules": {
    "@interlace/browser-security/no-dynamic-service-worker-url": [
      "error",
      {
        "allowInTests": true
      }
    ]
  }
}
```

## Known False Negatives

The following patterns are **not detected** due to static analysis limitations:

### URL from Configuration

**Why**: Config values not analyzed.

```typescript
// ‚ùå NOT DETECTED - From config
navigator.serviceWorker.register(config.serviceWorkerUrl);
```

**Mitigation**: Hardcode service worker URLs.

### Aliased Register Function

**Why**: Aliased functions not traced.

```typescript
// ‚ùå NOT DETECTED - Aliased
const registerSW = navigator.serviceWorker.register.bind(
  navigator.serviceWorker,
);
registerSW(dynamicUrl);
```

**Mitigation**: Avoid aliasing register function.

## üìö Related Resources

- [MDN: Service Worker API](https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API)
- [Google: Service Worker Security](https://web.dev/service-worker-lifecycle/)

## Error Message Format

The rule provides **LLM-optimized error messages** (Compact 2-line format) with actionable security guidance:

```text
üîí [CWE-829](https://cwe.mitre.org/data/definitions/829.html) OWASP:A03 CVSS:7.5 | Untrusted Control Sphere Inclusion detected | HIGH
   Fix: Review and apply the recommended fix | https://owasp.org/Top10/A03_2021/
```

### Message Components

| Component | Purpose | Example |
| :--- | :--- | :--- |
| **Risk Standards** | Security benchmarks | [CWE-829](https://cwe.mitre.org/data/definitions/829.html) [OWASP:A03](https://owasp.org/Top10/A03_2021-Injection/) [CVSS:7.5](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) |
| **Issue Description** | Specific vulnerability | `Untrusted Control Sphere Inclusion detected` |
| **Severity & Compliance** | Impact assessment | `HIGH` |
| **Fix Instruction** | Actionable remediation | `Follow the remediation steps below` |
| **Technical Truth** | Official reference | [OWASP Top 10](https://owasp.org/Top10/A03_2021-Injection/) |
