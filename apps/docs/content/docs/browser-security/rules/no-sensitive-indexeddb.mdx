---
title: no-sensitive-indexeddb
description: Prevent storing sensitive data in IndexedDB.
---

# no-sensitive-indexeddb

Prevent storing sensitive data in IndexedDB.

## ‚ö†Ô∏è Security Issue

| Property     | Value                                                                                                 |
| ------------ | ----------------------------------------------------------------------------------------------------- |
| **CWE**      | [CWE-922: Insecure Storage of Sensitive Information](https://cwe.mitre.org/data/definitions/922.html) |
| **OWASP**    | A02:2021 - Cryptographic Failures                                                                     |
| **CVSS**     | 7.5 (High)                                                                                            |
| **Severity** | HIGH                                                                                                  |

## üìã Description

IndexedDB is accessible via JavaScript and can be stolen through XSS attacks. Sensitive data like passwords, tokens, and API keys should not be stored in client-side databases.

## ‚ùå Incorrect

```javascript
// Creating object store for sensitive data
db.createObjectStore('passwords');
db.createObjectStore('secrets');
db.createObjectStore('apiKeys');

// Storing sensitive data
store.add({ password: userPassword });
store.put({ apiKey: key });
```

## ‚úÖ Correct

```javascript
// Store non-sensitive data
db.createObjectStore('preferences');
db.createObjectStore('cachedData');

// Store user preferences
store.add({ theme: 'dark', language: 'en' });
```

## üõ†Ô∏è Options

```json
{
  "rules": {
    "@interlace/browser-security/no-sensitive-indexeddb": [
      "error",
      {
        "allowInTests": true
      }
    ]
  }
}
```

## Known False Negatives

The following patterns are **not detected** due to static analysis limitations:

### Dynamic Store Names

**Why**: Computed names not analyzed.

```typescript
// ‚ùå NOT DETECTED - Dynamic name
const name = 'passwords';
db.createObjectStore(name);
```

**Mitigation**: Use static store names. Avoid sensitive naming.

### Nested Sensitive Data

**Why**: Deep object properties not traced.

```typescript
// ‚ùå NOT DETECTED - Nested data
store.put({ user: { password: pwd } });
```

**Mitigation**: Never store sensitive data in IndexedDB.

### Library Wrappers

**Why**: IndexedDB wrappers not recognized.

```typescript
// ‚ùå NOT DETECTED - Dexie wrapper
db.secrets.add({ apiKey: key });
```

**Mitigation**: Apply rule to wrapper implementations.

## üìö Related Resources

- [MDN: IndexedDB](https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API)
- [OWASP: HTML5 Security](https://cheatsheetseries.owasp.org/cheatsheets/HTML5_Security_Cheat_Sheet.html)
