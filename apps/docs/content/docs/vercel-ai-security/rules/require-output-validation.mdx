---
title: "require-output-validation"
description: Requires validation of AI output before displaying to users.
---


import { FalseNegativeCTA, WhenNotToUse } from "@/components/RuleComponents";

> Requires validation of AI output before displaying to users.

## üìä Rule Details

| Property           | Value                                                                                                |
| ------------------ | ---------------------------------------------------------------------------------------------------- |
| **Type**           | suggestion                                                                                           |
| **Severity**       | üü° MEDIUM                                                                                            |
| **OWASP LLM**      | [LLM09: Misinformation](https://owasp.org/www-project-top-10-for-large-language-model-applications/) |
| **CWE**            | [CWE-707: Improper Neutralization](https://cwe.mitre.org/data/definitions/707.html)                  |
| **CVSS**           | 5.0                                                                                                  |
| **Config Default** | `off` (recommended), `error` (strict)                                                                |

## üîç What This Rule Detects

This rule identifies code patterns where AI-generated output is displayed to users without validation or fact-checking.

## ‚ùå Incorrect Code

```typescript
// Direct AI output display
display(result.text);

// Unvalidated response content
render(response.content);

// AI output in object
respond({ message: result.text });
```

## ‚úÖ Correct Code

```typescript
// Validated output
display(validateOutput(result.text));

// Fact-checked output
render(factCheck(response.content));

// Sanitized in object
respond({ message: sanitize(result.text) });
```

## ‚öôÔ∏è Options

| Option               | Type       | Default                                           | Description                            |
| -------------------- | ---------- | ------------------------------------------------- | -------------------------------------- |
| `displayPatterns`    | `string[]` | `['render', 'display', 'show', 'send']`           | Patterns suggesting display operations |
| `validatorFunctions` | `string[]` | `['validate', 'verify', 'factCheck', 'sanitize']` | Functions that validate output         |

## üõ°Ô∏è Why This Matters

Unvalidated AI output can:

- **Spread misinformation** - AI hallucinations presented as fact
- **Cause harm** - Medical, legal, financial misinformation
- **Damage reputation** - Incorrect information attributed to your brand
- **Violate regulations** - False claims in regulated industries


<WhenNotToUse />

## Known False Negatives

<FalseNegativeCTA />

The following patterns are **not detected** due to static analysis limitations:

### Validation in Separate Module

**Why**: Validation logic in other files is not linked.

```typescript
// ‚ùå NOT DETECTED - Validation elsewhere
import { processOutput } from './output-handler'; // Has validation
display(processOutput(result.text));
```

**Mitigation**: Document validation requirements. Review output handlers.

### Custom Display Functions

**Why**: Non-standard display functions may not be recognized.

```typescript
// ‚ùå NOT DETECTED - Custom display function
customRenderer.showContent(result.text); // Not in displayPatterns
```

**Mitigation**: Configure `displayPatterns` with custom function names.

### Implicit Validation

**Why**: Validation logic that doesn't match pattern is not recognized.

```typescript
// ‚ùå NOT DETECTED - Custom validation
display(checkContent(result.text)); // checkContent not in validatorFunctions
```

**Mitigation**: Configure `validatorFunctions` with custom names.

### Streaming Output

**Why**: Streamed content is displayed incrementally.

```typescript
// ‚ùå NOT DETECTED - Streaming without validation
for await (const chunk of streamText({ ... })) {
  display(chunk.text); // Each chunk unvalidated
}
```

**Mitigation**: Validate streamed content before display.

## üìö References

- [OWASP LLM09: Misinformation](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
- [CWE-707: Improper Neutralization](https://cwe.mitre.org/data/definitions/707.html)
