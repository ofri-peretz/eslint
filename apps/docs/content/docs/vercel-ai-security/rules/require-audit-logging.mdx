---
title: "`require-audit-logging`"
description: Suggests audit logging for AI SDK operations.
---

> Suggests audit logging for AI SDK operations.

## üìä Rule Details

| Property           | Value                                                                            |
| ------------------ | -------------------------------------------------------------------------------- |
| **Type**           | suggestion                                                                       |
| **Severity**       | ‚ö™ LOW                                                                           |
| **OWASP Agentic**  | [ASI10: Logging & Monitoring](https://owasp.org)                                 |
| **CWE**            | [CWE-778: Insufficient Logging](https://cwe.mitre.org/data/definitions/778.html) |
| **CVSS**           | 4.0                                                                              |
| **Config Default** | `off` (recommended, strict)                                                      |

## üîç What This Rule Detects

This rule identifies AI SDK calls that aren't preceded by logging statements. Audit logging is important for security monitoring and debugging.

## ‚ùå Incorrect Code

```typescript
// No logging
async function handler() {
  const result = await generateText({
    prompt: userInput,
  });
  return result.text;
}

// Missing audit trail
export async function processRequest(req) {
  await streamText({
    prompt: req.body.message,
  });
}
```

## ‚úÖ Correct Code

```typescript
// With logging
async function handler() {
  logger.info('AI generation started', { userId, promptHash });
  try {
    const result = await generateText({
      prompt: userInput,
    });
    logger.info('AI generation completed', { userId, tokens: result.usage });
    return result.text;
  } catch (error) {
    logger.error('AI generation failed', { userId, error });
    throw error;
  }
}

// Console log (acceptable)
export async function processRequest(req) {
  console.log('Processing AI request', { requestId });
  await streamText({
    prompt: req.body.message,
  });
}
```

## ‚öôÔ∏è Options

| Option         | Type      | Default | Description             |
| -------------- | --------- | ------- | ----------------------- |
| `allowInTests` | `boolean` | `true`  | Skip rule in test files |

## üõ°Ô∏è Why This Matters

Insufficient logging makes it impossible to:

- **Detect abuse** - Identify malicious usage patterns
- **Debug issues** - Trace problems in production
- **Audit compliance** - Prove regulatory compliance
- **Monitor costs** - Track API usage

## üîó Related Rules

- [`require-error-handling`](./require-error-handling.md) - Handle errors
- [`require-tool-confirmation`](./require-tool-confirmation.md) - Log destructive operations

## Known False Negatives

The following patterns are **not detected** due to static analysis limitations:

### Logging in Wrapper Function

**Why**: Logging in called functions is not visible.

```typescript
// ‚ùå NOT DETECTED - Logging in wrapper
await myGenerateText(prompt); // Wrapper has logging
```

**Mitigation**: Apply rule to wrapper implementations.

### Custom Logger Methods

**Why**: Non-standard logger methods may not be recognized.

```typescript
// ‚ùå NOT DETECTED - Custom logger
myLogger.audit('AI call', { prompt }); // Not in default patterns
await generateText({ prompt });
```

**Mitigation**: Configure rule for custom logger method names.

### Centralized Logging Middleware

**Why**: Framework-level logging is not linked.

```typescript
// ‚ùå NOT DETECTED (correctly) - Middleware logs all AI calls
app.use(aiAuditMiddleware);
```

**Mitigation**: Document centralized logging. Consider rule exception.

### Async Logging

**Why**: Logging scheduled for later may not be detected.

```typescript
// ‚ùå NOT DETECTED - Deferred logging
const result = await generateText({ prompt });
queueAuditLog({ prompt, result }); // Async logging
```

**Mitigation**: Use synchronous logging before AI calls.

## üìö References

- [OWASP ASI10: Logging & Monitoring](https://owasp.org)
- [CWE-778: Insufficient Logging](https://cwe.mitre.org/data/definitions/778.html)

## Error Message Format

The rule provides **LLM-optimized error messages** (Compact 2-line format) with actionable security guidance:

```text
‚ö†Ô∏è [CWE-778](https://cwe.mitre.org/data/definitions/778.html) OWASP:A09 CVSS:5.3 | Insufficient Logging detected | MEDIUM [SOC2,ISO27001,PCI-DSS,NIST-CSF]
   Fix: Review and apply the recommended fix | https://owasp.org/Top10/A09_2021/
```

### Message Components

| Component | Purpose | Example |
| :--- | :--- | :--- |
| **Risk Standards** | Security benchmarks | [CWE-778](https://cwe.mitre.org/data/definitions/778.html) [OWASP:A09](https://owasp.org/Top10/A09_2021-Injection/) [CVSS:5.3](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) |
| **Issue Description** | Specific vulnerability | `Insufficient Logging detected` |
| **Severity & Compliance** | Impact assessment | `MEDIUM [SOC2,ISO27001,PCI-DSS,NIST-CSF]` |
| **Fix Instruction** | Actionable remediation | `Follow the remediation steps below` |
| **Technical Truth** | Official reference | [OWASP Top 10](https://owasp.org/Top10/A09_2021-Injection/) |
