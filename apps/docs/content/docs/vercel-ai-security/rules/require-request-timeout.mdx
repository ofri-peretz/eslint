---
title: "`require-request-timeout`"
description: Requires timeout configuration for AI SDK calls to prevent DoS.
---

> Requires timeout configuration for AI SDK calls to prevent DoS.

## üìä Rule Details

| Property           | Value                                                                                                         |
| ------------------ | ------------------------------------------------------------------------------------------------------------- |
| **Type**           | suggestion                                                                                                    |
| **Severity**       | üü° MEDIUM                                                                                                     |
| **OWASP LLM**      | [LLM04: Model Denial of Service](https://owasp.org/www-project-top-10-for-large-language-model-applications/) |
| **CWE**            | [CWE-400: Uncontrolled Resource Consumption](https://cwe.mitre.org/data/definitions/400.html)                 |
| **CVSS**           | 5.0                                                                                                           |
| **Config Default** | `warn` (recommended), `error` (strict)                                                                        |

## üîç What This Rule Detects

This rule identifies AI SDK calls that don't have timeout or abort signal configuration.

## ‚ùå Incorrect Code

```typescript
// No timeout
await generateText({
  model: openai('gpt-4'),
  prompt: 'Hello',
});

// Missing timeout in stream
await streamText({
  model: openai('gpt-4'),
  prompt: userInput,
  maxTokens: 4096,
});
```

## ‚úÖ Correct Code

```typescript
// With abort signal timeout
const controller = new AbortController();
setTimeout(() => controller.abort(), 30000);
await generateText({
  model: openai('gpt-4'),
  prompt: 'Hello',
  abortSignal: controller.signal,
});

// With timeout property
await streamText({
  model: openai('gpt-4'),
  prompt: userInput,
  timeout: 30000,
});
```

## ‚öôÔ∏è Options

| Option         | Type      | Default | Description        |
| -------------- | --------- | ------- | ------------------ |
| `allowInTests` | `boolean` | `true`  | Skip in test files |

## üõ°Ô∏è Why This Matters

Missing timeouts can cause:

- **Denial of service** - Requests hang indefinitely
- **Resource exhaustion** - Threads/connections blocked
- **Cost explosion** - Long-running requests accumulate costs
- **Poor UX** - Users wait forever

## Known False Negatives

The following patterns are **not detected** due to static analysis limitations:

### Options from Variable

**Why**: Options stored in variables are not analyzed.

```typescript
// ‚ùå NOT DETECTED - Options from variable
const opts = { model: openai('gpt-4'), prompt: 'Hello' }; // No timeout
await generateText(opts);
```

**Mitigation**: Use inline options. Always specify timeout.

### Wrapper Functions

**Why**: Custom wrappers may include timeout internally.

```typescript
// ‚ùå NOT DETECTED - Wrapper adds timeout
await myGenerateText(prompt); // Wrapper sets timeout
```

**Mitigation**: Apply rule to wrapper implementations.

### External Timeout Management

**Why**: Timeout managed outside the call is not visible.

```typescript
// ‚ùå NOT DETECTED - Promise.race timeout
await Promise.race([
  generateText({ ... }),
  timeout(30000)
]);
```

**Mitigation**: Use built-in timeout/abort signal properties.

### Framework-Level Timeouts

**Why**: Framework request timeouts are not linked.

```typescript
// ‚ùå NOT DETECTED (correctly) - Express timeout middleware
app.use(timeout(30000));
```

**Mitigation**: Document framework timeout handling.

## üìö References

- [OWASP LLM04: Model Denial of Service](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
- [CWE-400: Uncontrolled Resource Consumption](https://cwe.mitre.org/data/definitions/400.html)

## Error Message Format

The rule provides **LLM-optimized error messages** (Compact 2-line format) with actionable security guidance:

```text
üîí CWE-400 OWASP:A06 CVSS:7.5 | Uncontrolled Resource Consumption (ReDoS) detected | HIGH
   Fix: Review and apply the recommended fix | https://owasp.org/Top10/A06_2021/
```

### Message Components

| Component | Purpose | Example |
| :--- | :--- | :--- |
| **Risk Standards** | Security benchmarks | [CWE-400](https://cwe.mitre.org/data/definitions/400.html) [OWASP:A06](https://owasp.org/Top10/A06_2021-Injection/) [CVSS:7.5](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) |
| **Issue Description** | Specific vulnerability | `Uncontrolled Resource Consumption (ReDoS) detected` |
| **Severity & Compliance** | Impact assessment | `HIGH` |
| **Fix Instruction** | Actionable remediation | `Follow the remediation steps below` |
| **Technical Truth** | Official reference | [OWASP Top 10](https://owasp.org/Top10/A06_2021-Injection/) |
