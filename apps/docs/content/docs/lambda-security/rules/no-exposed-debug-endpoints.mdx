---
title: no-exposed-debug-endpoints
description: Detect debug endpoints without auth in AWS Lambda handlers
---

# no-exposed-debug-endpoints (Lambda)

> **Keywords:** AWS Lambda, debug endpoint, admin path, exposed routes, event.path, rawPath, serverless security, CWE-489, OWASP M8, test endpoints, information disclosure, unauthorized access

**CWE:** [CWE-489](https://cwe.mitre.org/data/definitions/489.html)  
**OWASP Mobile:** [OWASP Mobile Top 10 M8](https://owasp.org/www-project-mobile-top-10/)

Identifies potential debug, administration, or testing endpoints that are often left exposed in production environments without proper authentication. This rule is part of [`eslint-plugin-lambda-security`](https://www.npmjs.com/package/eslint-plugin-lambda-security) and provides LLM-optimized error messages.

**üö® Security rule** | **üí° Provides LLM-optimized guidance** | **‚ö†Ô∏è Set to error in `recommended`**

## Quick Summary

| Aspect            | Details                                                                   |
| :---------------- | :------------------------------------------------------------------------ |
| **CWE Reference** | [CWE-489](https://cwe.mitre.org/data/definitions/489.html) (Active Debug) |
| **Severity**      | üü† HIGH (security misconfiguration)                                       |
| **Auto-Fix**      | ‚ùå Not available                                                          |
| **Category**      | Environment & Platform Security                                           |
| **ESLint MCP**    | ‚úÖ Optimized                                                              |
| **Best For**      | AWS Lambda Handlers                                                       |

## Rule Details

This rule scans for path checks against the Lambda `event` object (e.g., `event.path`, `event.rawPath`) and literal string constants that match known sensitive paths.

## ‚ùå Incorrect

```typescript
export const handler = async (event) => {
  // ‚ùå Explicit check for a debug path in a Lambda handler
  if (event.path === '/debug') {
    return {
      statusCode: 200,
      body: JSON.stringify(process.env),
    };
  }

  // ‚ùå Admin path check
  if (event.rawPath.includes('/admin')) {
    return runAdminTask();
  }
};

// ‚ùå Literal string matching a forbidden path
const myPath = '/test-endpoint';

// ‚ùå Serverless configuration (serverless.ts)
export const config = {
  functions: {
    debug: {
      events: [{ http: { path: '/debug' } }],
    },
  },
};
```

## ‚úÖ Correct

```typescript
export const handler = async (event) => {
  // ‚úÖ Standard production path check
  if (event.path === '/api/v1/user') {
    return getUser();
  }

  // ‚úÖ Health check with non-sensitive name
  if (event.path === '/status-check') {
    return { ok: true };
  }
};
```

## ‚öôÔ∏è Configuration

| Option        | Type       | Default           | Description                                  |
| :------------ | :--------- | :---------------- | :------------------------------------------- |
| `endpoints`   | `string[]` | `['/debug', ...]` | Custom list of debug/admin endpoints to flag |
| `ignoreFiles` | `string[]` | `[]`              | List of files or patterns to ignore          |

### Example Configuration

```json
{
  "rules": {
    "lambda-security/no-exposed-debug-endpoints": [
      "error",
      {
        "endpoints": ["/_internal", "/dev-console"],
        "ignoreFiles": ["tests/**/*.ts"]
      }
    ]
  }
}
```

## Known False Negatives

- Values stored in variables/constants used in path comparisons.
- Complex path parsing logic that doesn't use direct property access on the `event` object.

## References

- [CWE-489](https://cwe.mitre.org/data/definitions/489.html)
- [AWS Lambda Security Best Practices](https://docs.aws.amazon.com/lambda/latest/dg/security-best-practices.html)
