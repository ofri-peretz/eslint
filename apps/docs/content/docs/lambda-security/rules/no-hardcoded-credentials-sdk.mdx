---
title: no-hardcoded-credentials-sdk
description: "CWE: [CWE-522](https://cwe.mitre.org/data/definitions/522.html)"
---

> **Keywords:** AWS credentials, hardcoded secrets, [CWE-798](https://cwe.mitre.org/data/definitions/798.html), security, ESLint rule, Lambda, SDK, credential provider, auto-fix, LLM-optimized
**CWE:** [CWE-522](https://cwe.mitre.org/data/definitions/522.html)  
**OWASP Mobile:** [M1: Improper Credential Usage](https://owasp.org/www-project-mobile-top-10/)

Detects hardcoded AWS credentials in SDK client configurations. This rule is part of [`eslint-plugin-lambda-security`](https://www.npmjs.com/package/eslint-plugin-lambda-security) and provides LLM-optimized error messages.

‚ö†Ô∏è This rule **_errors_** by default in the `recommended` config.

## Quick Summary

| Aspect            | Details                                                  |
| ----------------- | -------------------------------------------------------- |
| **CWE Reference** | [CWE-798](https://cwe.mitre.org/data/definitions/798.html) (Use of Hard-coded Credentials)                  |
| **Severity**      | üî¥ Critical                                              |
| **Auto-Fix**      | ‚úÖ Yes (suggests credential provider)                    |
| **Category**      | Security                                                 |
| **Best For**      | AWS Lambda handlers, SDK configurations, serverless apps |

## Vulnerability and Risk

**Vulnerability:** Hardcoded AWS access keys in source code can be extracted from compiled artifacts, leaked in version control, or exposed through code sharing.

**Risk:** Attackers gaining access to AWS credentials can:

- Access and exfiltrate data from S3, DynamoDB, etc.
- Spin up resources for crypto mining
- Delete or encrypt data for ransom
- Pivot to other AWS services

## Rule Logic Flow

```mermaid
%%{init: {
  'theme': 'base',
  'themeVariables': {
    'primaryColor': '#f8fafc',
    'primaryTextColor': '#1e293b',
    'primaryBorderColor': '#334155',
    'lineColor': '#475569'
  }
}}%%
flowchart TD
    A[üîç NewExpression Found] --> B{AWS SDK Client?}
    B -->|No| C[‚úÖ Skip]
    B -->|Yes| D{Has credentials object?}
    D -->|No| C
    D -->|Yes| E{Check credential properties}
    E --> F{accessKeyId literal?}
    F -->|Yes| G{Matches AKIA/ASIA pattern?}
    G -->|Yes| H[üö® Report Error]
    G -->|No| C
    F -->|No| I{secretAccessKey literal?}
    I -->|Yes| J{Length >= 20?}
    J -->|Yes| H
    J -->|No| C
    I -->|No| C
    H --> K[üí° Suggest Credential Provider]

    classDef startNode fill:#f0fdf4,stroke:#16a34a,stroke-width:2px
    classDef errorNode fill:#fef2f2,stroke:#dc2626,stroke-width:2px
    classDef processNode fill:#eff6ff,stroke:#2563eb,stroke-width:2px
    classDef skipNode fill:#f1f5f9,stroke:#64748b,stroke-width:2px

    class A startNode
    class H errorNode
    class D,E,F,G,I,J processNode
    class C skipNode
```

## Examples

### ‚ùå Incorrect

```javascript
import { S3Client } from '@aws-sdk/client-s3';

// Hardcoded credentials - CRITICAL VULNERABILITY
const client = new S3Client({
  credentials: {
    accessKeyId: 'AKIAIOSFODNN7EXAMPLE',
    secretAccessKey: 'wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY',
  },
});

// DynamoDB with hardcoded keys
const dynamodb = new DynamoDBClient({
  credentials: {
    accessKeyId: 'ASIAIOSFODNN7EXAMPLE',
    secretAccessKey: 'someSecretKey123456789012345678901234',
  },
});
```

### ‚úÖ Correct

```javascript
import { S3Client } from '@aws-sdk/client-s3';
import { fromNodeProviderChain } from '@aws-sdk/credential-providers';

// Use credential provider chain - SAFE
const client = new S3Client({
  credentials: fromNodeProviderChain(),
});

// Lambda automatically uses execution role - SAFE
const client = new S3Client({});

// Environment variables (handled by Lambda) - SAFE
const client = new S3Client({
  credentials: {
    accessKeyId: process.env.AWS_ACCESS_KEY_ID,
    secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY,
  },
});
```

## Detection Patterns

| Pattern                      | Risk Level  | Description                        |
| ---------------------------- | ----------- | ---------------------------------- |
| `AKIA*` access key           | üî¥ Critical | IAM user access key (permanent)    |
| `ASIA*` access key           | üî¥ Critical | STS temporary access key           |
| Literal `secretAccessKey`    | üî¥ Critical | Any hardcoded secret (>=20 chars)  |
| Template literal credentials | üü° High     | Dynamic construction is suspicious |

## Options

| Option         | Type      | Default | Description                               |
| -------------- | --------- | ------- | ----------------------------------------- |
| `allowInTests` | `boolean` | `true`  | Allow hardcoded credentials in test files |

```json
{
  "rules": {
    "lambda-security/no-hardcoded-credentials-sdk": [
      "error",
      {
        "allowInTests": true
      }
    ]
  }
}
```

## Best Practices

### 1. Use Lambda Execution Role

```javascript
// Lambda automatically assumes its execution role
// No credentials needed!
const client = new S3Client({});
```

### 2. Use Credential Provider Chain

```javascript
import { fromNodeProviderChain } from '@aws-sdk/credential-providers';

const client = new S3Client({
  credentials: fromNodeProviderChain(),
});
```

### 3. Use AWS Secrets Manager for Third-Party Credentials

```javascript
import {
  SecretsManagerClient,
  GetSecretValueCommand,
} from '@aws-sdk/client-secrets-manager';

async function getCredentials() {
  const client = new SecretsManagerClient({});
  const response = await client.send(
    new GetSecretValueCommand({ SecretId: 'my-api-key' }),
  );
  return JSON.parse(response.SecretString);
}
```

## Related Rules

- [`no-secrets-in-env`](./no-secrets-in-env.md) - Detects secrets in environment variable definitions
- [`no-env-logging`](./no-env-logging.md) - Detects logging of environment variables

## Known False Negatives

The following patterns are **not detected** due to static analysis limitations:

### Credentials from Variable

**Why**: Credential objects stored in variables are not analyzed.

```typescript
// ‚ùå NOT DETECTED - Credentials from variable
const creds = {
  accessKeyId: 'AKIAIOSFODNN7EXAMPLE',
  secretAccessKey: 'wJalrXUtnFEMI/K7MDENG...',
};
const client = new S3Client({ credentials: creds });
```

**Mitigation**: Use credential providers. Never store credentials in variables.

### Credentials from Import

**Why**: Credentials imported from other modules are not visible.

```typescript
// ‚ùå NOT DETECTED - Credentials from import
import { awsCredentials } from './config';
const client = new S3Client({ credentials: awsCredentials });
```

**Mitigation**: Apply rule to config modules. Use credential providers.

### Base64/Encoded Credentials

**Why**: Encoded credentials are not decoded.

```typescript
// ‚ùå NOT DETECTED - Encoded credentials
const key = Buffer.from('QUtJQUlP...', 'base64').toString();
const client = new S3Client({
  credentials: { accessKeyId: key, secretAccessKey: '...' },
});
```

**Mitigation**: Never encode credentials as an obfuscation technique.

### Third-Party AWS Wrappers

**Why**: Only official AWS SDK patterns are recognized.

```typescript
// ‚ùå NOT DETECTED - Third-party wrapper
import { createS3Client } from 'my-aws-helper';
const client = createS3Client({
  accessKeyId: 'AKIA...',
});
```

**Mitigation**: Configure rule for third-party library patterns.

## Resources

- [CWE-798: Use of Hard-coded Credentials](https://cwe.mitre.org/data/definitions/798.html)
- [AWS SDK Credential Providers](https://docs.aws.amazon.com/sdk-for-javascript/v3/developer-guide/setting-credentials-node.html)
- [Lambda Execution Role](https://docs.aws.amazon.com/lambda/latest/dg/lambda-intro-execution-role.html)

## Error Message Format

The rule provides **LLM-optimized error messages** (Compact 2-line format) with actionable security guidance:

```text
üîí [CWE-798](https://cwe.mitre.org/data/definitions/798.html) OWASP:A04 CVSS:9.8 | Hardcoded Credentials detected | CRITICAL [SOC2,PCI-DSS,HIPAA,GDPR,ISO27001,NIST-CSF]
   Fix: Review and apply the recommended fix | https://owasp.org/Top10/A04_2021/
```

### Message Components

| Component | Purpose | Example |
| :--- | :--- | :--- |
| **Risk Standards** | Security benchmarks | [CWE-798](https://cwe.mitre.org/data/definitions/798.html) [OWASP:A04](https://owasp.org/Top10/A04_2021-Injection/) [CVSS:9.8](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) |
| **Issue Description** | Specific vulnerability | `Hardcoded Credentials detected` |
| **Severity & Compliance** | Impact assessment | `CRITICAL [SOC2,PCI-DSS,HIPAA,GDPR,ISO27001,NIST-CSF]` |
| **Fix Instruction** | Actionable remediation | `Follow the remediation steps below` |
| **Technical Truth** | Official reference | [OWASP Top 10](https://owasp.org/Top10/A04_2021-Injection/) |
