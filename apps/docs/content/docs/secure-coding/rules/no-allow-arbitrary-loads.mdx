---
title: no-allow-arbitrary-loads
description: "Prevents disabling App Transport Security (ATS) by detecting allowArbitraryLoads: true in configuration."
---


import { FalseNegativeCTA, WhenNotToUse } from "@/components/RuleComponents";

> **Keywords:** ATS, App Transport Security, iOS security, CWE-295, NSAppTransportSecurity, allowArbitraryLoads, mobile security

Prevents disabling App Transport Security (ATS) by detecting `allowArbitraryLoads: true` in configuration.

‚ö†Ô∏è This rule **errors** by default in the `recommended` config.

## Quick Summary

| Aspect            | Details                                                                                      |
| ----------------- | -------------------------------------------------------------------------------------------- |
| **CWE Reference** | [CWE-295](https://cwe.mitre.org/data/definitions/295.html) (Improper Certificate Validation) |
| **OWASP Mobile**  | [M5: Insecure Communication](https://owasp.org/www-project-mobile-top-10/)                   |
| **Severity**      | High                                                                                         |
| **Category**      | Mobile Security                                                                              |

## Rule Details

App Transport Security (ATS) enforces secure connections for iOS/macOS applications. Setting `allowArbitraryLoads: true` disables this protection entirely, allowing insecure HTTP connections and weakening certificate validation.

This rule detects configuration that disables ATS protection.

## Examples

### ‚ùå Incorrect

```javascript
// Disabling ATS entirely - DANGEROUS
const config = {
  NSAppTransportSecurity: {
    allowArbitraryLoads: true, // Allows all insecure connections
  },
};

// In Info.plist configuration (parsed as JSON)
const plist = {
  NSAppTransportSecurity: {
    NSAllowsArbitraryLoads: true,
    allowArbitraryLoads: true,
  },
};
```

### ‚úÖ Correct

```javascript
// Keep ATS enabled (default)
const config = {
  NSAppTransportSecurity: {
    allowArbitraryLoads: false, // Or omit entirely
  },
};

// Allow exceptions only for specific domains
const config = {
  NSAppTransportSecurity: {
    NSExceptionDomains: {
      'legacy-api.example.com': {
        NSTemporaryExceptionAllowsInsecureHTTPLoads: true,
      },
    },
  },
};
```

## Error Message Format

When triggered, this rule produces:

```
üîí CWE-295 | Prevent configuration allowing insecure loads detected - allowArbitraryLoads: true | HIGH
   Fix: Review and apply secure practices | https://cwe.mitre.org/data/definitions/295.html
```


<WhenNotToUse />

## Known False Negatives

<FalseNegativeCTA />

The following patterns are **not detected** due to static analysis limitations:

### Dynamic Configuration

**Why**: Configuration values set dynamically at runtime cannot be traced.

```typescript
// ‚ùå NOT DETECTED - Dynamic value
const enableInsecure = process.env.ALLOW_INSECURE === 'true';
const config = { allowArbitraryLoads: enableInsecure };
```

**Mitigation**: Never use environment variables to control security settings.

### Configuration in External Files

**Why**: Rule only checks JavaScript/TypeScript, not Info.plist XML.

```xml
{/*  ‚ùå NOT DETECTED - XML plist  */}
<key>NSAppTransportSecurity</key>
<dict>
  <key>NSAllowsArbitraryLoads</key>
  <true/>
</dict>
```

**Mitigation**: Use plist linting tools for native iOS configuration.

## When Not To Use It

- In development environments with local HTTP servers (use domain exceptions instead)
- When targeting iOS 8 or earlier (ATS was introduced in iOS 9)

## Further Reading

- [OWASP Mobile Top 10 - M5: Insecure Communication](https://owasp.org/www-project-mobile-top-10/)
- [Apple ATS Documentation](https://developer.apple.com/documentation/security/preventing_insecure_network_connections)
- [CWE-295: Improper Certificate Validation](https://cwe.mitre.org/data/definitions/295.html)

## Related Rules

- [no-disabled-certificate-validation](./no-disabled-certificate-validation.md)
- [no-insecure-ssl](./no-insecure-ssl.md) (in eslint-plugin-pg)

---

**Category:** Mobile Security  
**Type:** Problem  
**Recommended:** Yes
