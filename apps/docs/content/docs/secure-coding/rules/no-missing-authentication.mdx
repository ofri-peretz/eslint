---
title: no-missing-authentication
description: Detects missing authentication checks in route handlers. This rule is part of eslint-plugin-secure-coding and provides LLM-optimized error messages that AI assi
---


import { FalseNegativeCTA, WhenNotToUse } from "@/components/RuleComponents";

> **Keywords:** missing authentication, CWE-287, security, ESLint rule, authentication middleware, route handlers, Express, Fastify, API security, access control, LLM-optimized, code security

Detects missing authentication checks in route handlers. This rule is part of [`eslint-plugin-secure-coding`](https://www.npmjs.com/package/eslint-plugin-secure-coding) and provides LLM-optimized error messages that AI assistants can automatically fix.

‚ö†Ô∏è This rule **_warns_** by default in the `recommended` config.

## Quick Summary

| Aspect            | Details                                                            |
| ----------------- | ------------------------------------------------------------------ |
| **CWE Reference** | CWE-287 (Improper Authentication)                                  |
| **Severity**      | Critical (security vulnerability)                                  |
| **Auto-Fix**      | ‚ùå No (requires manual authentication setup)                       |
| **Category**      | Security                                                           |
| **ESLint MCP**    | ‚úÖ Optimized for ESLint MCP integration                            |
| **Best For**      | All web applications with API endpoints, Express, Fastify, Next.js |

## Vulnerability and Risk

**Vulnerability:** Missing authentication checks in API route handlers or controller methods allow anonymous or unauthenticated users to access endpoints that should be protected.

**Risk:** Unauthorized access to sensitive data or functionality. This can lead to data breaches, modification of data by unauthorized users, or access to privileged administrative functions.

## Rule Details

Missing authentication checks allow unauthorized access to protected resources. This rule detects route handlers that don't have authentication middleware configured.

### Why This Matters

| Issue                | Impact                         | Solution                      |
| -------------------- | ------------------------------ | ----------------------------- |
| üîí **Security**      | Unauthorized access to APIs    | Add authentication middleware |
| üêõ **Data Breach**   | Sensitive data exposure        | Protect all endpoints         |
| üîê **Compliance**    | Violates security standards    | Enforce authentication        |
| üìä **Best Practice** | All protected routes need auth | Use auth middleware           |

## Detection Patterns

The rule detects:

- **Express routes**: `app.get()`, `app.post()`, `app.put()`, `app.delete()`, `app.patch()`, `app.all()`
- **Route handlers without authentication middleware** in arguments
- **Common auth middleware patterns**: `authenticate`, `auth`, `requireAuth`, `isAuthenticated`, `verifyToken`, `checkAuth`, `ensureAuthenticated`, `passport.authenticate`, `jwt`, `session`

## Examples

### ‚ùå Incorrect

```typescript
// Missing authentication on protected route
app.get('/api/users', (req, res) => {
  // ‚ùå No auth middleware
  // Return user data
});

app.post('/api/users', (req, res) => {
  // ‚ùå No auth middleware
  // Create user
});

router.put('/api/users/:id', (req, res) => {
  // ‚ùå No auth middleware
  // Update user
});
```

### ‚úÖ Correct

```typescript
// Authentication middleware added
app.get('/api/users', authenticate(), (req, res) => {
  // ‚úÖ Auth middleware
  // Return user data
});

app.post('/api/users', auth, requireAuth, (req, res) => {
  // ‚úÖ Multiple auth checks
  // Create user
});

router.put('/api/users/:id', verifyToken(), (req, res) => {
  // ‚úÖ Token verification
  // Update user
});

// Public route (can be ignored via options)
app.get('/api/public', (req, res) => {
  // ‚úÖ Public endpoint
  // Return public data
});
```

## Configuration

### Default Configuration

```json
{
  "secure-coding/no-missing-authentication": "warn"
}
```

### Options

| Option                   | Type       | Default                                   | Description                           |
| ------------------------ | ---------- | ----------------------------------------- | ------------------------------------- |
| `allowInTests`           | `boolean`  | `false`                                   | Allow missing auth in tests           |
| `testFilePattern`        | `string`   | `'\\.(test\|spec)\\.(ts\|tsx\|js\|jsx)$'` | Test file pattern regex               |
| `authMiddlewarePatterns` | `string[]` | `['authenticate', 'auth', ...]`           | Auth middleware patterns to recognize |
| `routeHandlerPatterns`   | `string[]` | `['get', 'post', ...]`                    | Route handler patterns to check       |
| `ignorePatterns`         | `string[]` | `[]`                                      | Additional patterns to ignore         |

### Example Configuration

```json
{
  "secure-coding/no-missing-authentication": [
    "error",
    {
      "allowInTests": true,
      "authMiddlewarePatterns": ["authenticate", "myCustomAuth"],
      "routeHandlerPatterns": ["get", "post", "put", "delete"],
      "ignorePatterns": ["/api/public"]
    }
  ]
}
```

## Best Practices

1. **Always add authentication** to protected routes
2. **Use middleware**: Leverage Express/Fastify middleware for consistent auth
3. **Public routes**: Explicitly mark public routes or use ignore patterns
4. **Token validation**: Verify JWT/session tokens on all protected endpoints
5. **Role-based access**: Combine with role checks for fine-grained control


<WhenNotToUse />

## Known False Negatives

<FalseNegativeCTA />

The following patterns are **not detected** due to static analysis limitations:

### Credentials from Config

**Why**: Config values not traced.

```typescript
// ‚ùå NOT DETECTED - From config
const password = config.dbPassword;
```

**Mitigation**: Use proper secrets management.

### Environment Variables

**Why**: Env var content not analyzed.

```typescript
// ‚ùå NOT DETECTED - Env var
const secret = process.env.API_KEY;
```

**Mitigation**: Never hardcode or expose secrets.

### Dynamic Credential Access

**Why**: Dynamic property access not traced.

```typescript
// ‚ùå NOT DETECTED - Dynamic
const cred = credentials[type];
```

**Mitigation**: Audit all credential access patterns.

## Related Rules

- [`no-privilege-escalation`](./no-privilege-escalation.md) - Detects privilege escalation vulnerabilities
- [`no-unvalidated-user-input`](./no-unvalidated-user-input.md) - Detects unvalidated user input

## Resources

- [CWE-287: Improper Authentication](https://cwe.mitre.org/data/definitions/287.html)
- [OWASP: Improper Authentication](https://owasp.org/www-community/vulnerabilities/Improper_Authentication)
- [Express Authentication Guide](https://expressjs.com/en/guide/using-middleware.html)
